{% extends "base.html" %}

{% block title %}Login - Savage Homeschool OS{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-4">
        <div class="card">
            <div class="card-body text-center p-5">
                <div class="mb-4">
                    <i class="fas fa-graduation-cap" style="font-size: 3rem; color: var(--secondary-color);"></i>
                    <h2 class="mt-3">Welcome Back!</h2>
                    <p class="text-muted">Sign in to continue your learning journey</p>
                </div>
                
                <form method="POST" action="{{ url_for('login') }}">
                    <div class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-user"></i>
                            </span>
                            <input type="text" class="form-control" id="username" name="username" required>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="password" class="form-label">Password (for Admin/Parent)</label>
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-lock"></i>
                            </span>
                            <input type="password" class="form-control" id="password" name="password">
                        </div>
                        <small class="text-muted">Leave blank for child login</small>
                    </div>
                    
                    <div class="mb-3">
                        <label for="pin" class="form-label">PIN (for Child)</label>
                        <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-key"></i>
                            </span>
                            <input type="password" class="form-control" id="pin" name="pin" maxlength="6" pattern="[0-9]*">
                        </div>
                        <small class="text-muted">6-digit PIN for child accounts</small>
                    </div>
                    
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                </form>
                
                <div class="mt-4">
                    <h5>Quick Login Guide:</h5>
                    <div class="row text-start">
                        <div class="col-12">
                            <div class="alert alert-info">
                                <strong>Admin:</strong> username + password<br>
                                <strong>Parent:</strong> username + password<br>
                                <strong>Child:</strong> username + PIN
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h6>Default Login:</h6>
                    <div class="row text-start">
                        <div class="col-12">
                            <div class="alert alert-warning">
                                <strong>Admin:</strong> admin / admin123<br>
                                <small class="text-muted">Change this password after first login!</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Demo Accounts Info -->
<div class="row justify-content-center mt-4">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-info-circle"></i> Getting Started</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <div class="text-center">
                            <i class="fas fa-user-shield" style="font-size: 2rem; color: var(--accent-color);"></i>
                            <h6 class="mt-2">Admin Access</h6>
                            <p class="small text-muted">Full system control, user management, content upload</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <i class="fas fa-users" style="font-size: 2rem; color: var(--secondary-color);"></i>
                            <h6 class="mt-2">Parent Access</h6>
                            <p class="small text-muted">Monitor progress, assign lessons, manage rewards</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <i class="fas fa-child" style="font-size: 2rem; color: var(--success-color);"></i>
                            <h6 class="mt-2">Child Access</h6>
                            <p class="small text-muted">Complete lessons, earn XP, unlock rewards</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Auto-focus on username field
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('username').focus();
    });
    
    // PIN input formatting
    document.getElementById('pin').addEventListener('input', function(e) {
        // Only allow numbers
        this.value = this.value.replace(/[^0-9]/g, '');
        
        // Limit to 6 digits
        if (this.value.length > 6) {
            this.value = this.value.slice(0, 6);
        }
    });
    
    // Show/hide password toggle
    function togglePasswordVisibility(inputId) {
        const input = document.getElementById(inputId);
        const icon = input.nextElementSibling.querySelector('i');
        
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }
    
    // Form validation
    document.querySelector('form').addEventListener('submit', function(e) {
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value;
        const pin = document.getElementById('pin').value;
        
        if (!username) {
            e.preventDefault();
            alert('Please enter a username');
            return;
        }
        
        // Check if it's a child login (has PIN) or admin/parent login (has password)
        if (pin && !password) {
            // Child login
            if (pin.length !== 6) {
                e.preventDefault();
                alert('PIN must be 6 digits');
                return;
            }
        } else if (password && !pin) {
            // Admin/Parent login
            if (password.length < 3) {
                e.preventDefault();
                alert('Password must be at least 3 characters');
                return;
            }
        } else {
            e.preventDefault();
            alert('Please enter either a password (for Admin/Parent) or PIN (for Child)');
            return;
        }
    });
</script>
{% endblock %} 